<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parse and Render Molecular Structures in 3D • raymolecule</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Parse and Render Molecular Structures in 3D">
<meta property="og:description" content="Downloads and parses SDF (Structural Description Format) and PDB (Protein Database) files for 3D rendering.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">raymolecule</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>

    functions
  </a>
</li>
<li>
  <a href="https://github.com/tylermorganwall/raymolecule" class="external-link">
    <span class="fa fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="raymolecule">raymolecule<a class="anchor" aria-label="anchor" href="#raymolecule"></a>
</h1></div>
<p><img src="reference/figures/caff.gif"></p>
<!-- badges: start -->

<p><code>raymolecule</code> is an R package to parse and render molecules in 3D. Rendering is powered by two packages: <a href="https://www.rayrender.net/" class="external-link">rayrender</a> package, a pathtracer for R, and <a href="https://www.rayvertex.com/" class="external-link">rayvertex</a>, a rasterizer for R. <code>raymolecule</code> currently supports and parses SDF (structure-data file) and PDB (Protein Data Bank) files and returns a <code>rayrender</code> scene, which we then pathtrace and visualize in R. This initial release of the package only supports visualizing atoms and bonds.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of raymolecule from Github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tylermorganwall/raymolecule"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p><code>raymolecule</code> includes several example SDF files for the following molecules: “benzene”, “buckyball”, “caffeine”, “capsaicin”, “cinnemaldehyde”, “geraniol”, “luciferin”, “morphine”, “penicillin”, “pfoa”, “skatole”, “tubocurarine_chloride”. You can get the file path to these example files using the <code><a href="reference/get_example_molecule.html">get_example_molecule()</a></code> function. We pass this path to the <code><a href="reference/read_sdf.html">read_sdf()</a></code> file to parse the file and extract the atom coordinates and bond information in a list. <code>raymolecule</code> also includes the ability to fetch molecules from PubChem using the <code><a href="reference/get_molecule.html">get_molecule()</a></code> function. The magrittr pipe is automatically imported in the package, so we will use it to pass the output of each function to the input of the next.</p>
<p>Here’s the format of the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.raymolecule.com/" class="external-link">raymolecule</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/get_example_molecule.html">get_example_molecule</a></span><span class="op">(</span><span class="st">"benzene"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/read_sdf.html">read_sdf</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $atoms</span></span>
<span><span class="co">#&gt;          x       y      z type index</span></span>
<span><span class="co">#&gt; 1  -1.2131 -0.6884  0e+00    C     1</span></span>
<span><span class="co">#&gt; 2  -1.2028  0.7064  1e-04    C     2</span></span>
<span><span class="co">#&gt; 3  -0.0103 -1.3948  0e+00    C     3</span></span>
<span><span class="co">#&gt; 4   0.0104  1.3948 -1e-04    C     4</span></span>
<span><span class="co">#&gt; 5   1.2028 -0.7063  0e+00    C     5</span></span>
<span><span class="co">#&gt; 6   1.2131  0.6884  0e+00    C     6</span></span>
<span><span class="co">#&gt; 7  -2.1577 -1.2244  0e+00    H     7</span></span>
<span><span class="co">#&gt; 8  -2.1393  1.2564  1e-04    H     8</span></span>
<span><span class="co">#&gt; 9  -0.0184 -2.4809 -1e-04    H     9</span></span>
<span><span class="co">#&gt; 10  0.0184  2.4808  0e+00    H    10</span></span>
<span><span class="co">#&gt; 11  2.1394 -1.2563  1e-04    H    11</span></span>
<span><span class="co">#&gt; 12  2.1577  1.2245  0e+00    H    12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bonds</span></span>
<span><span class="co">#&gt;    from to number</span></span>
<span><span class="co">#&gt; 1     1  2      2</span></span>
<span><span class="co">#&gt; 2     1  3      1</span></span>
<span><span class="co">#&gt; 3     1  7      1</span></span>
<span><span class="co">#&gt; 4     2  4      1</span></span>
<span><span class="co">#&gt; 5     2  8      1</span></span>
<span><span class="co">#&gt; 6     3  5      2</span></span>
<span><span class="co">#&gt; 7     3  9      1</span></span>
<span><span class="co">#&gt; 8     4  6      2</span></span>
<span><span class="co">#&gt; 9     4 10      1</span></span>
<span><span class="co">#&gt; 10    5  6      1</span></span>
<span><span class="co">#&gt; 11    5 11      1</span></span>
<span><span class="co">#&gt; 12    6 12      1</span></span></code></pre></div>
<p>Alternatively, you can fetch any molecule from <a href="https://pubchem.ncbi.nlm.nih.gov" class="external-link">PubChem</a> by passing either the molecule name. You can also fetch a molecule using the official compound ID (CID), in case you have a specific molecule with a long name or unique isoform:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="reference/get_molecule.html">get_molecule</a></span><span class="op">(</span><span class="st">"estradiol"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ atoms:'data.frame':   44 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ x    : num [1:44] 5.061 -5.857 2.664 1.984 0.515 ...</span></span>
<span><span class="co">#&gt;   ..$ y    : num [1:44] 1.15 0.148 0.584 -0.695 -0.78 ...</span></span>
<span><span class="co">#&gt;   ..$ z    : num [1:44] 0.2674 0.4388 0.1481 -0.3789 0.0353 ...</span></span>
<span><span class="co">#&gt;   ..$ type : chr [1:44] "O" "O" "C" "C" ...</span></span>
<span><span class="co">#&gt;   ..$ index: int [1:44] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ bonds:'data.frame':   47 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ from  : num [1:47] 1 1 2 2 3 3 3 3 4 4 ...</span></span>
<span><span class="co">#&gt;   ..$ to    : num [1:47] 7 40 20 44 4 7 8 13 5 9 ...</span></span>
<span><span class="co">#&gt;   ..$ number: num [1:47] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="reference/get_molecule.html">get_molecule</a></span><span class="op">(</span><span class="fl">5757</span><span class="op">)</span><span class="op">)</span> <span class="co">#this is the CID for estradiol (aka estrogen)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ atoms:'data.frame':   44 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ x    : num [1:44] 5.061 -5.857 2.664 1.984 0.515 ...</span></span>
<span><span class="co">#&gt;   ..$ y    : num [1:44] 1.15 0.148 0.584 -0.695 -0.78 ...</span></span>
<span><span class="co">#&gt;   ..$ z    : num [1:44] 0.2674 0.4388 0.1481 -0.3789 0.0353 ...</span></span>
<span><span class="co">#&gt;   ..$ type : chr [1:44] "O" "O" "C" "C" ...</span></span>
<span><span class="co">#&gt;   ..$ index: int [1:44] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ bonds:'data.frame':   47 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ from  : num [1:47] 1 1 2 2 3 3 3 3 4 4 ...</span></span>
<span><span class="co">#&gt;   ..$ to    : num [1:47] 7 40 20 44 4 7 8 13 5 9 ...</span></span>
<span><span class="co">#&gt;   ..$ number: num [1:47] 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>We can then pass the list from <code>get_example_molecule() |&gt; read_sdf()</code> or from <code><a href="reference/get_molecule.html">get_molecule()</a></code> to the <code><a href="reference/generate_full_scene.html">generate_full_scene()</a></code>, <code><a href="reference/generate_atom_scene.html">generate_atom_scene()</a></code>, or <code><a href="reference/generate_bond_scene.html">generate_bond_scene()</a></code> functions to convert this representation to a rayrender/rayvertex scene. This can then be passed on the <code><a href="reference/render_model.html">render_model()</a></code> function, which will call rayrender’s <code><a href="http://www.rayrender.net/reference/render_scene.html" class="external-link">render_scene()</a></code> or rayvertex’s <code>rasterize_scene()</code> functions to render it. This function automatically ensures the molecule is centered and in frame, and sets up lighting, and can accept arguments to rotate the molecule. For more rendering options, see <code><a href="http://www.rayrender.net/reference/render_scene.html" class="external-link">rayrender::render_scene()</a></code> and <code><a href="https://www.rayvertex.com/reference/rasterize_scene.html" class="external-link">rayvertex::rasterize_scene()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#Specify a width, height, and number of samples for the image (more samples == less noise)</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">get_example_molecule</span>(<span class="st">"caffeine"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="fu">read_sdf</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="fu">generate_full_scene</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="fu">render_model</span>(<span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>, <span class="at">samples =</span> <span class="dv">32</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#Light from both bottom and top</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">get_example_molecule</span>(<span class="st">"cinnemaldehyde"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="fu">read_sdf</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    <span class="fu">generate_full_scene</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="fu">render_model</span>(<span class="at">lights =</span> <span class="st">"both"</span>, <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>, <span class="at">samples =</span> <span class="dv">32</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#Rotate the molecule and add a non-zero aperture setting to get depth of field effect</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">get_example_molecule</span>(<span class="st">"penicillin"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    <span class="fu">read_sdf</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    <span class="fu">generate_full_scene</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    <span class="fu">render_model</span>(</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>        <span class="at">lights =</span> <span class="st">"both"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">800</span>,</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">800</span>,</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>        <span class="at">samples =</span> <span class="dv">64</span>,</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>        <span class="at">angle =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">0</span>),</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>        <span class="at">aperture =</span> <span class="dv">2</span>,</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>        <span class="at">fov =</span> <span class="dv">22</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; Error in parse(text = input): &lt;text&gt;:26:0: unexpected end of input</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; 24:                 fov = 22</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; 25: </span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt;    ^</span></span></code></pre></div>
<p>We can use <code>rayvertex</code> to render images much more quickly and noise free, as well as include a toon cel-shading effect.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(rayvertex)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#Render a basic example with rayvertex</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">get_example_molecule</span>(<span class="st">"tubocurarine_chloride"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="fu">read_sdf</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="fu">generate_full_scene</span>(<span class="at">pathtrace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="fu">render_model</span>(<span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>, <span class="at">background =</span> <span class="st">"grey66"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#Customize the material with toon shading</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>shiny_toon_material <span class="ot">=</span> <span class="fu">material_list</span>(</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"toon_phong"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    <span class="at">toon_levels =</span> <span class="dv">3</span>,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    <span class="at">toon_outline_width =</span> <span class="dv">10</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="fu">get_example_molecule</span>(<span class="st">"morphine"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>    <span class="fu">read_sdf</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    <span class="fu">generate_full_scene</span>(</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>        <span class="at">pathtrace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>        <span class="at">material_vertex =</span> shiny_toon_material</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>    <span class="fu">render_model</span>(<span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>, <span class="at">background =</span> <span class="st">"grey66"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#Customize the lights with rayvertex</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="fu">get_example_molecule</span>(<span class="st">"skatole"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="fu">read_sdf</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    <span class="fu">generate_full_scene</span>(<span class="at">pathtrace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>    <span class="fu">render_model</span>(</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">800</span>,</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">800</span>,</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>        <span class="at">angle =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">0</span>),</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>        <span class="at">background =</span> <span class="st">"grey66"</span>,</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>        <span class="at">lights =</span> <span class="fu">directional_light</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>            <span class="fu">add_light</span>(<span class="fu">directional_light</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>))</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#&gt; Error in parse(text = input): &lt;text&gt;:35:0: unexpected end of input</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co">#&gt; 33:                         add_light(directional_light(c(0, -1, 0), color = "red"))</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="co">#&gt; 34: </span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a><span class="co">#&gt;    ^</span></span></code></pre></div>
<p>You can turn off lighting in <code><a href="reference/render_model.html">render_model()</a></code> and customize the scene (adding different objects or lights) by using rayrender’s <code><a href="http://www.rayrender.net/reference/add_object.html" class="external-link">add_object()</a></code> function or rayvertex’s <code>add_shape()</code> function. If you use <code><a href="http://www.rayrender.net/reference/render_scene.html" class="external-link">rayrender::render_scene()</a></code>/<code><a href="https://www.rayvertex.com/reference/rasterize_scene.html" class="external-link">rayvertex::rasterize_scene()</a></code> instead of <code><a href="reference/render_model.html">render_model()</a></code>, you have to set up the camera position and field of view yourself.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rayrender.net" class="external-link">rayrender</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">buckyball</span> <span class="op">=</span> <span class="fu"><a href="reference/get_example_molecule.html">get_example_molecule</a></span><span class="op">(</span><span class="st">"buckyball"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/read_sdf.html">read_sdf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/generate_full_scene.html">generate_full_scene</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Add custom lighting, with a custom position determined interactively</span></span>
<span><span class="co"># in rayrender by moving to the desired position and pressing "P" to get</span></span>
<span><span class="co"># the coordinates.</span></span>
<span><span class="va">buckyball</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://www.rayrender.net/reference/add_object.html" class="external-link">add_object</a></span><span class="op">(</span><span class="fu"><a href="http://www.rayrender.net/reference/sphere.html" class="external-link">sphere</a></span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="fl">12</span>,</span>
<span>        radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        material <span class="op">=</span> <span class="fu"><a href="http://www.rayrender.net/reference/light.html" class="external-link">light</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, intensity <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://www.rayrender.net/reference/add_object.html" class="external-link">add_object</a></span><span class="op">(</span><span class="fu"><a href="http://www.rayrender.net/reference/sphere.html" class="external-link">sphere</a></span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="op">-</span><span class="fl">12</span>,</span>
<span>        radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        material <span class="op">=</span> <span class="fu"><a href="http://www.rayrender.net/reference/light.html" class="external-link">light</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, intensity <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://www.rayrender.net/reference/add_object.html" class="external-link">add_object</a></span><span class="op">(</span><span class="fu"><a href="http://www.rayrender.net/reference/sphere.html" class="external-link">sphere</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="fl">12</span>,</span>
<span>        radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        material <span class="op">=</span> <span class="fu"><a href="http://www.rayrender.net/reference/light.html" class="external-link">light</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"dodgerblue"</span>, intensity <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://www.rayrender.net/reference/add_object.html" class="external-link">add_object</a></span><span class="op">(</span><span class="fu"><a href="http://www.rayrender.net/reference/sphere.html" class="external-link">sphere</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="op">-</span><span class="fl">12</span>,</span>
<span>        radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        material <span class="op">=</span> <span class="fu"><a href="http://www.rayrender.net/reference/light.html" class="external-link">light</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span>, intensity <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/render_model.html">render_model</a></span><span class="op">(</span></span>
<span>        lights <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        width <span class="op">=</span> <span class="fl">800</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">800</span>,</span>
<span>        samples <span class="op">=</span> <span class="fl">64</span>,</span>
<span>        fov <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        aperture <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; --------------------------Interactive Mode Controls---------------------------</span></span>
<span><span class="co">#&gt; W/A/S/D: Horizontal Movement: | Q/Z: Vertical Movement | Up/Down: Adjust FOV | ESC: Close</span></span>
<span><span class="co">#&gt; Left/Right: Adjust Aperture  | 1/2: Adjust Focal Distance | 3/4: Rotate Environment Light </span></span>
<span><span class="co">#&gt; P: Print Camera Info | R: Reset Camera |  TAB: Toggle Orbit Mode |  E/C: Adjust Step Size</span></span>
<span><span class="co">#&gt; K: Save Keyframe | L: Reset Camera to Last Keyframe (if set) | F: Toggle Fast Travel Mode</span></span>
<span><span class="co">#&gt; Left Mouse Click: Change Look At (new focal distance) | Right Mouse Click: Change Look At</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7" width="100%"><p class="caption">
plot of chunk unnamed-chunk-7
</p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Generate ground underneath the model and use a light to cast a shadow</span></span>
<span><span class="fu"><a href="http://www.rayrender.net/reference/generate_ground.html" class="external-link">generate_ground</a></span><span class="op">(</span>depth <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, material <span class="op">=</span> <span class="fu"><a href="http://www.rayrender.net/reference/diffuse.html" class="external-link">diffuse</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://www.rayrender.net/reference/add_object.html" class="external-link">add_object</a></span><span class="op">(</span><span class="va">buckyball</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://www.rayrender.net/reference/add_object.html" class="external-link">add_object</a></span><span class="op">(</span><span class="fu"><a href="http://www.rayrender.net/reference/sphere.html" class="external-link">sphere</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">8</span>, z <span class="op">=</span> <span class="fl">12</span>, material <span class="op">=</span> <span class="fu"><a href="http://www.rayrender.net/reference/light.html" class="external-link">light</a></span><span class="op">(</span>intensity <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://www.rayrender.net/reference/render_scene.html" class="external-link">render_scene</a></span><span class="op">(</span></span>
<span>        width <span class="op">=</span> <span class="fl">800</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">800</span>,</span>
<span>        samples <span class="op">=</span> <span class="fl">64</span>,</span>
<span>        aperture <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        fov <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        lookfrom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.96</span>, <span class="fl">0.99</span>, <span class="fl">29.43</span><span class="op">)</span>,</span>
<span>        lookat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">0.26</span>, <span class="fl">3.91</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; --------------------------Interactive Mode Controls---------------------------</span></span>
<span><span class="co">#&gt; W/A/S/D: Horizontal Movement: | Q/Z: Vertical Movement | Up/Down: Adjust FOV | ESC: Close</span></span>
<span><span class="co">#&gt; Left/Right: Adjust Aperture  | 1/2: Adjust Focal Distance | 3/4: Rotate Environment Light </span></span>
<span><span class="co">#&gt; P: Print Camera Info | R: Reset Camera |  TAB: Toggle Orbit Mode |  E/C: Adjust Step Size</span></span>
<span><span class="co">#&gt; K: Save Keyframe | L: Reset Camera to Last Keyframe (if set) | F: Toggle Fast Travel Mode</span></span>
<span><span class="co">#&gt; Left Mouse Click: Change Look At (new focal distance) | Right Mouse Click: Change Look At</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-7-2.png" alt="plot of chunk unnamed-chunk-7" width="100%"><p class="caption">
plot of chunk unnamed-chunk-7
</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=raymolecule" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/tylermorganwall/raymolecule/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tylermorganwall/raymolecule/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing raymolecule</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.tylermw.com" class="external-link">Tyler Morgan-Wall</a> <br><small class="roles"> Author, copyright holder, maintainer </small> <a href="https://orcid.org/0000-0002-3131-3814" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tylermorganwall/raymolecule/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tylermorganwall/raymolecule/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.tylermw.com" class="external-link">Tyler Morgan-Wall</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
